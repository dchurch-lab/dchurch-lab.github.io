install.packages("prettydoc")
# points with boxplot
df %>%
ggplot(aes(sample_name, expression, color = gene_id)) +
geom_point(position = position_jitterdodge(), size = 2) +
geom_boxplot(width = .5, alpha = .6, outlier.shape = NA,
color = "grey60", notch = TRUE) +
facet_wrap(~gene_id) +
scale_color_nejm() +
labs(title = "Example jitter with boxplot",
y = "Normalised expression") +
theme(text = element_text(size = 14), title = element_text(size = 18),
axis.title.x = element_blank(), legend.position = "none",
panel.border = element_rect(colour = "black", fill = NA))
# load the precious libraries
library(tidyverse)
library(ggsci)
# set the defauts for plots
theme_set(theme_classic())
theme_update(legend.position = "bottom")
df <-
data.frame(
sample_name = c(rep("sample_A", 15), rep("sample_B", 5)),
gene_1 = c(rnorm(15, 1), rnorm(5, 3)),
gene_2 = c(rnorm(15, 10, 5), rnorm(5, 10, 2)),
gene_3 = c(rnorm(15, 10, 1), rnorm(5, 9, 3))
) %>%
pivot_longer(names_to = "gene_id",
values_to = "expression",
-sample_name)
# points with mean
df %>%
ggplot(aes(sample_name, expression, color = gene_id)) +
geom_point(position = position_jitterdodge(), size = 2) +
stat_summary(fun.y = mean, fun.ymin = mean, fun.ymax = mean,
geom = "crossbar", alpha = .7,
width = 0.5, color = "grey60") +
facet_wrap(~gene_id) +
scale_color_nejm() +
labs(title = "Example jitter with mean",
y = "Normalised expression") +
theme(text = element_text(size = 14), title = element_text(size = 18),
axis.title.x = element_blank(), legend.position = "none",
panel.border = element_rect(colour = "black", fill = NA))
# points with boxplot
df %>%
ggplot(aes(sample_name, expression, color = gene_id)) +
geom_point(position = position_jitterdodge(), size = 2) +
geom_boxplot(width = .5, alpha = .6, outlier.shape = NA,
color = "grey60", notch = TRUE) +
facet_wrap(~gene_id) +
scale_color_nejm() +
labs(title = "Example jitter with boxplot",
y = "Normalised expression") +
theme(text = element_text(size = 14), title = element_text(size = 18),
axis.title.x = element_blank(), legend.position = "none",
panel.border = element_rect(colour = "black", fill = NA))
# points with boxplot
df %>%
ggplot(aes(sample_name, expression, color = gene_id)) +
geom_point(position = position_jitterdodge(), size = 2) +
geom_boxplot(width = .5, alpha = .4, outlier.shape = NA,
color = "grey60") +
facet_wrap(~gene_id) +
scale_color_nejm() +
labs(title = "Example jitter with boxplot",
y = "Normalised expression") +
theme(text = element_text(size = 14), title = element_text(size = 18),
axis.title.x = element_blank(), legend.position = "none",
panel.border = element_rect(colour = "black", fill = NA))
# points with boxplot
df %>%
ggplot(aes(sample_name, expression, color = gene_id)) +
geom_point(position = position_jitterdodge(), size = 2) +
geom_boxplot(width = .2, alpha = .4, outlier.shape = NA,
color = "grey60") +
facet_wrap(~gene_id) +
scale_color_nejm() +
labs(title = "Example jitter with boxplot",
y = "Normalised expression") +
theme(text = element_text(size = 14), title = element_text(size = 18),
axis.title.x = element_blank(), legend.position = "none",
panel.border = element_rect(colour = "black", fill = NA))
set.seed(7)
# points with mean
df %>%
ggplot(aes(sample_name, expression, color = gene_id)) +
geom_point(position = position_jitterdodge(), size = 2) +
stat_summary(fun.y = mean, fun.ymin = mean, fun.ymax = mean,
geom = "crossbar", alpha = .7,
width = 0.5, color = "grey60") +
facet_wrap(~gene_id) +
scale_color_nejm() +
labs(title = "Example jitter with mean",
y = "Normalised expression") +
theme(text = element_text(size = 14), title = element_text(size = 18),
axis.title.x = element_blank(), legend.position = "none",
panel.border = element_rect(colour = "black", fill = NA))
